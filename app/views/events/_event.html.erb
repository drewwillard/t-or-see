<div id="<%= dom_id event %>">
  <% if event.display_image %>
    <div class="event-poster">
      <% begin %>
        <%= image_tag event.display_image.variant(resize_to_limit: [400, 400]), class: "img-fluid rounded" %>
        <% if !event.poster.attached? && event.location.image.attached? %>
          <small class="text-muted">Using location image</small>
        <% end %>
      <% rescue => e %>
        <div class="alert alert-warning">Image processing error: <%= e.message %></div>
      <% end %>
    </div>
  <% end %>

  <h2>
    <p>
      <%= event.title %>
    </p>
  </h2>
  <p>
    <strong>Date:</strong>
    <%= event.date %>
  </p>

  <p>
    <strong>Time:</strong>
    <%= event.start_time.strftime('%I:%M %p') if event.start_time.present? %> - 
    <%= event.end_time.strftime('%I:%M %p') if event.end_time.present? %>
  </p>

  <p>
    <strong>Location:</strong>
    <%= event.location.name %>
  </p>
  <div>
  <%= event.details%>
</div>

<div>
  <% if user_signed_in? %>
    <% if event.users.include?(current_user) %>
      <% attendee = event.attendees.find_by(user: current_user) %>
      <%= button_to "Reminder Added", attendee_path(attendee), method: :delete if attendee %>
    <% else %>
      <%= button_to "Remind Me", attendees_path, method: :post, params: { event_id: event.id } %>
    <% end %>
  <% else %>
    <%= link_to "Remind Me", auth_path(notification_alert: true), class: "btn btn-primary", data: { turbo: false } %>
  <% end %>
</div>

</div>
